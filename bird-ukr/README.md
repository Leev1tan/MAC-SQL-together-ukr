# Український BIRD-UKR бенчмарк

BIRD-UKR (Benchmarking Intermediate Reasoning for Ukrainian Text-to-SQL) - це український аналог набору даних BIRD для оцінки здатності моделей штучного інтелекту розуміти запити українською мовою та генерувати відповідні SQL-запити.

## Огляд

BIRD-UKR містить 8 різних баз даних PostgreSQL з різних доменів, а також колекцію природномовних питань українською мовою з відповідними SQL-запитами різного рівня складності.

Бенчмарк призначений для оцінки ефективності моделей Text-to-SQL на українській мові та порівняння різних підходів до перетворення тексту на SQL.

## Структура бенчмарку

```
bird-ukr/
├── README.md                     # Цей файл
├── questions.json                # Всі питання та SQL-запити
├── tables.json                   # Схеми баз даних (таблиці, колонки, ключі)
├── column_meaning.json           # Опис значення кожного стовпця
├── database/                     # Директорія з базами даних
│   ├── спортивний_клуб/          # База даних "Спортивний клуб"
│   │   ├── schema.sql            # Схема бази даних
│   │   ├── import.sql            # Скрипт для імпорту даних
│   │   ├── data_*.sql            # Файли з даними
│   │   └── README.md             # Опис бази даних
│   ├── лікарня/                  # База даних "Лікарня"
│   │   └── ...
│   └── ...                       # Інші бази даних
└── questions/                    # Окремі файли з питаннями для кожної бази
    ├── спортивний_клуб_questions.json
    └── ...
```

## Бази даних

BIRD-UKR містить наступні бази даних:

1. **Спортивний клуб** - база даних фітнес-клубу з інформацією про членів, тренерів, заняття та відвідування
2. **Лікарня** - база даних медичного закладу з лікарями, пацієнтами та процедурами
3. **Університет** - база даних навчального закладу зі студентами, викладачами та курсами
4. **Бібліотека** - база даних бібліотечної системи з книгами та читачами
5. **Інтернет-магазин** - база даних онлайн-магазину з товарами та замовленнями
6. **Ресторан** - база даних закладу харчування з меню та замовленнями
7. **Туристичне агентство** - база даних турагентства з турами та клієнтами
8. **Авіакомпанія** - база даних авіаперевезень з рейсами та пасажирами

## Типи питань

Питання в BIRD-UKR розділені на три рівні складності:

1. **Простий рівень (simple)** - запити з однією таблицею, простими умовами та сортуванням
2. **Середній рівень (medium)** - запити з декількома таблицями, агрегацією та групуванням
3. **Складний рівень (complex)** - запити з підзапитами, віконними функціями та складними умовами

## Формат питань

Питання зберігаються у форматі JSON та містять наступні поля:

```json
{
  "question_id": "спортивний_клуб_001",    // Унікальний ідентифікатор питання
  "db_id": "спортивний_клуб",              // Ідентифікатор бази даних
  "db_path": "database/спортивний_клуб",   // Шлях до бази даних відносно кореня проекту
  "question": "Скільки тренерів працює в спортивному клубі?", // Питання українською мовою
  "gold_sql": "SELECT COUNT(*) FROM тренери WHERE активний = TRUE", // Еталонний SQL-запит
  "difficulty": "simple",                  // Рівень складності: simple, medium або complex
  "evidence": null,                        // Додаткова інформація (опціонально)
  "execution_details": {                   // Деталі виконання запиту
    "execution_time": null,                // Час виконання (в секундах)
    "result_size": null                    // Кількість рядків у результаті
  }
}
```

## Метадані

BIRD-UKR містить два файли метаданих:

1. **tables.json** - інформація про схеми баз даних:
   - `table_names` - імена таблиць
   - `column_names` - імена колонок (пар [таблиця, колонка])
   - `column_types` - типи даних колонок
   - `foreign_keys` - зовнішні ключі у форматі [id_колонки_fk, id_колонки_pk]
   - `primary_keys` - ідентифікатори колонок, що є первинними ключами

2. **column_meaning.json** - опис значення кожного стовпця:
   - Ключі у форматі `таблиця.колонка`
   - Значення - текстовий опис призначення колонки

## Оцінка моделей

Для оцінки моделей використовуються дві метрики:

1. **Execution Accuracy (EX)** - відсоток запитів, що дають коректний результат при виконанні
2. **Exact Match Accuracy (EM)** - відсоток запитів, що точно співпадають з еталонними (з урахуванням нормалізації)

## Використання

### Оцінка моделі

```python
from bird_ukr.evaluation import evaluate_ex, evaluate_em

# Оцінка за Execution Accuracy
ex_score = evaluate_ex(predictions, gold_file="bird-ukr/questions.json", db_path="bird-ukr/database")

# Оцінка за Exact Match Accuracy
em_score = evaluate_em(predictions, gold_file="bird-ukr/questions.json")

print(f"Execution Accuracy: {ex_score:.2f}")
print(f"Exact Match Accuracy: {em_score:.2f}")
```

### Запуск тестування

```bash
# Повне тестування на всіх базах даних
python evaluation/benchmark.py --model [model_name] --output results/[model_name]_results.json

# Тестування на окремій базі даних
python evaluation/benchmark.py --model [model_name] --db спортивний_клуб --output results/[model_name]_спортивний_клуб.json
```

## Ліцензія

BIRD-UKR поширюється під ліцензією MIT.

## Контакти

З питань та пропозиціями щодо бенчмарку звертайтесь:
- Email: [адреса електронної пошти]
- GitHub: [посилання на репозиторій]

## Подяки

BIRD-UKR створено на основі архітектури бенчмарку [BIRD](https://bird-bench.github.io/) та модифіковано для української мови.
