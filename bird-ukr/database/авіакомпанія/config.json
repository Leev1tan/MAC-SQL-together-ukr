{
    "database_name": "авіакомпанія",
    "display_name": "Авіакомпанія",
    "description": "База даних для управління авіаперевезеннями, включаючи рейси, пасажирів, персонал, літаки та додаткові послуги.",
    "category": "транспорт",
    "tables": [
        {
            "name": "посади",
            "description": "Список посад персоналу авіакомпанії з їх назвами та базовими зарплатами",
            "columns": ["id", "назва", "опис", "базова_зарплата"]
        },
        {
            "name": "типи_літаків",
            "description": "Каталог типів літаків з технічними характеристиками",
            "columns": ["id", "назва", "виробник", "максимальна_дальність_польоту", "максимальна_швидкість", "максимальна_висота_польоту", "максимальна_кількість_пасажирів", "максимальна_вантажопідйомність"]
        },
        {
            "name": "статуси_рейсів",
            "description": "Можливі статуси рейсів (заплановано, в польоті, прибув тощо)",
            "columns": ["id", "назва", "опис"]
        },
        {
            "name": "класи_обслуговування",
            "description": "Класи обслуговування пасажирів (економ, бізнес, перший клас)",
            "columns": ["id", "назва", "опис", "коефіцієнт_вартості"]
        },
        {
            "name": "статуси_бронювань",
            "description": "Статуси бронювань квитків",
            "columns": ["id", "назва", "опис"]
        },
        {
            "name": "статуси_техобслуговування",
            "description": "Статуси процесів техобслуговування літаків",
            "columns": ["id", "назва", "опис"]
        },
        {
            "name": "методи_оплати",
            "description": "Методи оплати для бронювань",
            "columns": ["id", "назва", "опис"]
        },
        {
            "name": "персонал",
            "description": "Інформація про працівників авіакомпанії",
            "columns": ["id", "прізвище", "імя", "по_батькові", "дата_народження", "стать", "адреса", "телефон", "email", "дата_прийому_на_роботу", "посада_id", "зарплата", "статус", "примітки"]
        },
        {
            "name": "аеропорти",
            "description": "Інформація про аеропорти",
            "columns": ["id", "код_іата", "код_ікао", "назва", "місто", "країна", "часовий_пояс", "кількість_терміналів", "кількість_злітно_посадкових_смуг", "географічні_координати", "примітки"]
        },
        {
            "name": "літаки",
            "description": "Дані про літаки авіакомпанії",
            "columns": ["id", "реєстраційний_номер", "серійний_номер", "тип_літака_id", "рік_випуску", "дата_останнього_капітального_ремонту", "дата_останнього_техогляду", "загальний_наліт_годин", "статус", "примітки"]
        },
        {
            "name": "маршрути",
            "description": "Маршрути між аеропортами",
            "columns": ["id", "аеропорт_відправлення_id", "аеропорт_призначення_id", "відстань", "приблизний_час_польоту", "базова_вартість"]
        },
        {
            "name": "рейси",
            "description": "Заплановані та виконані рейси",
            "columns": ["id", "номер_рейсу", "маршрут_id", "літак_id", "дата_час_відправлення", "дата_час_прибуття", "фактичний_час_відправлення", "фактичний_час_прибуття", "статус_id", "кількість_місць_економ", "кількість_місць_бізнес", "кількість_місць_перший_клас", "доступно_місць_економ", "доступно_місць_бізнес", "доступно_місць_перший_клас", "вартість_економ", "вартість_бізнес", "вартість_перший_клас", "погодні_умови", "примітки"]
        },
        {
            "name": "пасажири",
            "description": "Інформація про пасажирів",
            "columns": ["id", "прізвище", "імя", "по_батькові", "дата_народження", "стать", "громадянство", "номер_паспорта", "серія_паспорта", "телефон", "email", "адреса", "примітки"]
        },
        {
            "name": "бронювання",
            "description": "Дані про бронювання квитків",
            "columns": ["id", "номер_бронювання", "рейс_id", "дата_бронювання", "клас_обслуговування_id", "кількість_місць", "загальна_вартість", "знижка_відсоток", "статус_id", "метод_оплати_id", "примітки"]
        },
        {
            "name": "бронювання_пасажири",
            "description": "Зв'язок між бронюваннями та пасажирами",
            "columns": ["id", "бронювання_id", "пасажир_id", "номер_місця"]
        },
        {
            "name": "рейси_персонал",
            "description": "Призначення персоналу на рейси",
            "columns": ["id", "рейс_id", "персонал_id", "роль"]
        },
        {
            "name": "послуги",
            "description": "Додаткові послуги для пасажирів",
            "columns": ["id", "назва", "опис", "вартість", "доступність_в_класах"]
        },
        {
            "name": "надані_послуги",
            "description": "Факти надання послуг пасажирам",
            "columns": ["id", "бронювання_id", "послуга_id", "кількість", "загальна_вартість", "дата_надання"]
        },
        {
            "name": "технічне_обслуговування",
            "description": "Записи про технічне обслуговування літаків",
            "columns": ["id", "літак_id", "тип_обслуговування", "опис", "дата_початку", "дата_завершення", "відповідальний_техніка_id", "статус_id", "вартість", "примітки"]
        }
    ],
    "foreign_keys": [
        {
            "table": "персонал",
            "column": "посада_id",
            "references": "посади",
            "ref_column": "id"
        },
        {
            "table": "літаки",
            "column": "тип_літака_id",
            "references": "типи_літаків",
            "ref_column": "id"
        },
        {
            "table": "маршрути",
            "column": "аеропорт_відправлення_id",
            "references": "аеропорти",
            "ref_column": "id"
        },
        {
            "table": "маршрути",
            "column": "аеропорт_призначення_id",
            "references": "аеропорти",
            "ref_column": "id"
        },
        {
            "table": "рейси",
            "column": "маршрут_id",
            "references": "маршрути",
            "ref_column": "id"
        },
        {
            "table": "рейси",
            "column": "літак_id",
            "references": "літаки",
            "ref_column": "id"
        },
        {
            "table": "рейси",
            "column": "статус_id",
            "references": "статуси_рейсів",
            "ref_column": "id"
        },
        {
            "table": "бронювання",
            "column": "рейс_id",
            "references": "рейси",
            "ref_column": "id"
        },
        {
            "table": "бронювання",
            "column": "клас_обслуговування_id",
            "references": "класи_обслуговування",
            "ref_column": "id"
        },
        {
            "table": "бронювання",
            "column": "статус_id",
            "references": "статуси_бронювань",
            "ref_column": "id"
        },
        {
            "table": "бронювання",
            "column": "метод_оплати_id",
            "references": "методи_оплати",
            "ref_column": "id"
        },
        {
            "table": "бронювання_пасажири",
            "column": "бронювання_id",
            "references": "бронювання",
            "ref_column": "id"
        },
        {
            "table": "бронювання_пасажири",
            "column": "пасажир_id",
            "references": "пасажири",
            "ref_column": "id"
        },
        {
            "table": "рейси_персонал",
            "column": "рейс_id",
            "references": "рейси",
            "ref_column": "id"
        },
        {
            "table": "рейси_персонал",
            "column": "персонал_id",
            "references": "персонал",
            "ref_column": "id"
        },
        {
            "table": "надані_послуги",
            "column": "бронювання_id",
            "references": "бронювання",
            "ref_column": "id"
        },
        {
            "table": "надані_послуги",
            "column": "послуга_id",
            "references": "послуги",
            "ref_column": "id"
        },
        {
            "table": "технічне_обслуговування",
            "column": "літак_id",
            "references": "літаки",
            "ref_column": "id"
        },
        {
            "table": "технічне_обслуговування",
            "column": "відповідальний_техніка_id",
            "references": "персонал",
            "ref_column": "id"
        },
        {
            "table": "технічне_обслуговування",
            "column": "статус_id",
            "references": "статуси_техобслуговування",
            "ref_column": "id"
        }
    ],
    "sample_queries": [
        {
            "question": "Які рейси заплановані на 15 серпня 2023 року?",
            "query": "SELECT r.номер_рейсу, r.дата_час_відправлення, r.дата_час_прибуття, a1.місто AS місто_відправлення, a2.місто AS місто_прибуття, s.назва AS статус FROM рейси r JOIN маршрути m ON r.маршрут_id = m.id JOIN аеропорти a1 ON m.аеропорт_відправлення_id = a1.id JOIN аеропорти a2 ON m.аеропорт_призначення_id = a2.id JOIN статуси_рейсів s ON r.статус_id = s.id WHERE DATE(r.дата_час_відправлення) = '2023-08-15' ORDER BY r.дата_час_відправлення;",
            "difficulty": "легкий"
        },
        {
            "question": "Скільки вільних місць у бізнес-класі залишилося на рейс PS202?",
            "query": "SELECT r.номер_рейсу, r.доступно_місць_бізнес FROM рейси r WHERE r.номер_рейсу = 'PS202';",
            "difficulty": "легкий"
        },
        {
            "question": "Скільки рейсів виконує авіакомпанія з Києва до Львова?",
            "query": "SELECT COUNT(*) FROM рейси r JOIN маршрути m ON r.маршрут_id = m.id JOIN аеропорти a1 ON m.аеропорт_відправлення_id = a1.id JOIN аеропорти a2 ON m.аеропорт_призначення_id = a2.id WHERE a1.місто = 'Київ' AND a2.місто = 'Львів';",
            "difficulty": "середній"
        },
        {
            "question": "Які пасажири зареєстровані на рейс PS101?",
            "query": "SELECT p.прізвище, p.імя, p.по_батькові, bp.номер_місця FROM пасажири p JOIN бронювання_пасажири bp ON p.id = bp.пасажир_id JOIN бронювання b ON bp.бронювання_id = b.id JOIN рейси r ON b.рейс_id = r.id WHERE r.номер_рейсу = 'PS101' ORDER BY bp.номер_місця;",
            "difficulty": "середній"
        },
        {
            "question": "Яка загальна сума доходу від бронювань на серпень 2023 року?",
            "query": "SELECT SUM(b.загальна_вартість) AS загальний_дохід FROM бронювання b JOIN рейси r ON b.рейс_id = r.id WHERE r.дата_час_відправлення BETWEEN '2023-08-01' AND '2023-08-31' AND b.статус_id = 2;",
            "difficulty": "середній"
        },
        {
            "question": "Хто з пілотів має найбільшу кількість рейсів?",
            "query": "SELECT p.прізвище, p.імя, COUNT(rp.id) AS кількість_рейсів FROM персонал p JOIN рейси_персонал rp ON p.id = rp.персонал_id JOIN посади pos ON p.посада_id = pos.id WHERE pos.назва IN ('Пілот', 'Другий пілот') GROUP BY p.id, p.прізвище, p.імя ORDER BY COUNT(rp.id) DESC LIMIT 1;",
            "difficulty": "середній"
        },
        {
            "question": "Скільки різних додаткових послуг було замовлено для кожного бронювання і на яку загальну суму?",
            "query": "SELECT b.номер_бронювання, COUNT(DISTINCT np.послуга_id) AS кількість_різних_послуг, SUM(np.загальна_вартість) AS загальна_сума FROM бронювання b LEFT JOIN надані_послуги np ON b.id = np.бронювання_id GROUP BY b.id, b.номер_бронювання ORDER BY SUM(np.загальна_вартість) DESC NULLS LAST;",
            "difficulty": "середній"
        },
        {
            "question": "Яке середнє завантаження рейсів (у відсотках) для економ-класу за маршрутами з Києва?",
            "query": "SELECT a2.місто AS місто_призначення, ROUND(AVG(100 - (r.доступно_місць_економ * 100.0 / r.кількість_місць_економ)), 2) AS середнє_завантаження_економ FROM рейси r JOIN маршрути m ON r.маршрут_id = m.id JOIN аеропорти a1 ON m.аеропорт_відправлення_id = a1.id JOIN аеропорти a2 ON m.аеропорт_призначення_id = a2.id WHERE a1.місто = 'Київ' GROUP BY a2.місто ORDER BY AVG(100 - (r.доступно_місць_економ * 100.0 / r.кількість_місць_економ)) DESC;",
            "difficulty": "складний"
        },
        {
            "question": "Який літак має найбільшу кількість технічних обслуговувань і яка їх загальна вартість?",
            "query": "SELECT l.реєстраційний_номер, tl.назва AS тип_літака, COUNT(to_date.id) AS кількість_обслуговувань, SUM(to_date.вартість) AS загальна_вартість FROM літаки l JOIN типи_літаків tl ON l.тип_літака_id = tl.id LEFT JOIN технічне_обслуговування to_date ON l.id = to_date.літак_id GROUP BY l.id, l.реєстраційний_номер, tl.назва ORDER BY COUNT(to_date.id) DESC LIMIT 1;",
            "difficulty": "складний"
        },
        {
            "question": "Які рейси мали найбільшу різницю між запланованим і фактичним часом прибуття?",
            "query": "SELECT r.номер_рейсу, r.дата_час_відправлення, r.дата_час_прибуття, r.фактичний_час_прибуття, EXTRACT(EPOCH FROM (r.фактичний_час_прибуття - r.дата_час_прибуття))/60 AS затримка_у_хвилинах FROM рейси r WHERE r.фактичний_час_прибуття IS NOT NULL ORDER BY EXTRACT(EPOCH FROM (r.фактичний_час_прибуття - r.дата_час_прибуття)) DESC LIMIT 5;",
            "difficulty": "складний"
        }
    ]
} 