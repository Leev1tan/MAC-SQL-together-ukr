# База даних "Туристичне агентство"

## Опис

База даних "Туристичне агентство" призначена для управління інформацією про діяльність туристичного агентства, включаючи клієнтів, працівників, тури, готелі, транспортні послуги, бронювання та платежі. Вона дозволяє ефективно управляти замовленнями, відстежувати бронювання та фінансові операції.

## Структура бази даних

База даних складається з наступних основних таблиць:

1. **Довідникові таблиці**:
   - `посади` - Посади працівників агентства
   - `країни` - Інформація про країни
   - `міста` - Інформація про міста
   - `типи_кімнат` - Типи номерів у готелях
   - `типи_транспорту` - Види транспорту
   - `статуси_бронювання` - Можливі статуси бронювань
   - `методи_оплати` - Способи оплати
   - `знижки` - Інформація про акційні пропозиції

2. **Основні таблиці**:
   - `працівники` - Співробітники туристичного агентства
   - `клієнти` - Клієнти агентства
   - `готелі` - Інформація про готелі
   - `транспорт` - Транспортні рейси
   - `тури` - Туристичні пакети
   - `бронювання_турів` - Інформація про бронювання турів
   - `бронювання_готелів` - Інформація про бронювання готелів
   - `бронювання_транспорту` - Інформація про бронювання транспорту
   - `платежі` - Фінансові операції
   - `відгуки` - Відгуки клієнтів про тури та готелі
   - `історія_пошуків` - Записи пошукових запитів клієнтів

3. **Додаткові таблиці**:
   - `логи_бронювань` - Історія змін статусів бронювань

## Діаграма бази даних

```
+---------------+     +-------------+     +-------------+     +----------------+
|   працівники  |     |   клієнти   |     |    тури     |     |     готелі     |
+---------------+     +-------------+     +-------------+     +----------------+
|     id (PK)   |     |   id (PK)   |     |   id (PK)   |     |     id (PK)    |
|    прізвище   |     |  прізвище   |     |    назва    |     |      назва     |
|      імя      |     |    імя      |     |    опис     |     |     адреса     |
|   посада_id   |---->|   телефон   |     | країна_id   |---->|    місто_id    |
+---------------+     +-------------+     |  місто_id   |     |     зірок      |
                                          | готель_id   |----<|      ...       |
+-----------------+                       |    ...      |     +----------------+
| бронювання_турів|                       +-------------+
+-----------------+                                 ^
|      id (PK)    |                                 |
|    клієнт_id    |-----------------------------+   |
|      тур_id     |-------------------------------->+
|    статус_id    |------>+                    |
|      ...        |       |                    |
+-----------------+       v                    v
                     +-----------+     +-------------+
                     |  статуси  |     |   платежі   |
                     +-----------+     +-------------+
                     |  id (PK)  |     |   id (PK)   |
                     |   назва   |     |бронювання_id|
                     +-----------+     |    сума     |
                                       |    ...      |
                                       +-------------+
```

## Особливості

1. **Тригери та автоматизація**:
   - Автоматичний розрахунок вартості зі знижкою при бронюванні туру
   - Автоматичне логування змін статусу бронювання
   - Автоматичний розрахунок тривалості туру

2. **Представлення (Views)**:
   - `активні_тури` - Інформація про доступні тури
   - `інформація_про_бронювання` - Деталі про всі бронювання
   - `рейтинг_турів` - Статистика рейтингу турів на основі відгуків

3. **Обмеження цілісності**:
   - Перевірка правильності email адрес
   - Перевірка дат (дата закінчення повинна бути пізніше дати початку)
   - Перевірка оцінок відгуків (від 1 до 5)
   - Обмеження на зіркість готелів (від 1 до 5)

## Приклади запитів

База даних підтримує різноманітні запити різної складності:

1. **Прості запити**:
   - Отримання списку активних турів
   - Пошук готелів за зірковістю
   - Виведення списку клієнтів

2. **Запити середньої складності**:
   - Аналіз бронювань за статусами
   - Визначення найпопулярніших турів
   - Розрахунок середніх оцінок для готелів

3. **Складні запити**:
   - Аналіз сезонності продажів
   - Статистика по працівниках та виручці
   - Визначення найпопулярніших маршрутів

## Використання

1. Створення бази даних:
   ```sql
   CREATE DATABASE туристичне_агентство;
   ```

2. Імпорт схеми:
   ```bash
   psql -d туристичне_агентство -f schema.sql
   ```

3. Імпорт даних:
   ```bash
   psql -d туристичне_агентство -f data.sql
   psql -d туристичне_агентство -f data_reference.sql
   psql -d туристичне_агентство -f data_staff.sql
   # та інші файли даних
   ```

4. Виконання запитів з файлу sample_queries.sql

## Файли проекту

- `schema.sql` - Схема бази даних
- `sample_queries.sql` - Приклади запитів різної складності
- `import.sql` - Скрипт для імпорту всіх даних
- `data.sql` - Загальні дані
- `data_reference.sql` - Довідкові дані (статуси, типи, методи оплати)
- `data_staff.sql` - Дані про працівників
- `data_countries.sql` - Дані про країни
- `data_cities.sql` - Дані про міста
- `data_hotels.sql` - Дані про готелі
- `data_transport.sql` - Дані про транспортні рейси
- `data_tours.sql` - Дані про тури
- `data_bookings.sql` - Дані про бронювання
- `data_payments.sql` - Дані про платежі
- `data_reviews.sql` - Дані про відгуки

## Розробники

Розроблено в рамках проекту створення українського набору даних для задач Text-to-SQL, подібного до англомовного набору BIRD. 