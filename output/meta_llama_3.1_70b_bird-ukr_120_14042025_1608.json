{
  "timestamp": "2025-04-14 16:35:06",
  "model": "meta-llama/Meta-Llama-3.1-70B-Instruct-Turbo",
  "dataset": "bird-ukr",
  "execution_accuracy": 0.5733333333333334,
  "num_samples": 75,
  "random_seed": null,
  "avg_gold_time": 0.0015080833435058593,
  "avg_pred_time": 0.0010943317413330078,
  "results": [
    {
      "question_id": "авіакомпанія_gen_001",
      "db_id": "авіакомпанія",
      "question": "Скільки аеропортів знаходиться у місті Київ?",
      "evidence": "",
      "gold_sql": "SELECT COUNT(*) FROM аеропорти WHERE місто = 'Київ';",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0020017623901367188,
      "pred_time": 0.0020024776458740234,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT COUNT(id)\n  FROM аеропорти\n  WHERE місто = 'Київ'"
    },
    {
      "question_id": "авіакомпанія_gen_002",
      "db_id": "авіакомпанія",
      "question": "Перелічіть назви та виробників типів літаків з пасажиромісткістю понад 250 осіб.",
      "evidence": "",
      "gold_sql": "SELECT назва, виробник FROM типи_літаків WHERE максимальна_кількість_пасажирів > 250;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0010013580322265625,
      "pred_time": 0.0010006427764892578,
      "execution_match": true,
      "exact_match": true,
      "pred_sql": "SELECT назва, виробник\n  FROM типи_літаків\n  WHERE максимальна_кількість_пасажирів > 250"
    },
    {
      "question_id": "авіакомпанія_gen_003",
      "db_id": "авіакомпанія",
      "question": "Які існують статуси рейсів?",
      "evidence": "",
      "gold_sql": "SELECT назва FROM статуси_рейсів;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.001001596450805664,
      "pred_time": 0.0010004043579101562,
      "execution_match": true,
      "exact_match": true,
      "pred_sql": "SELECT назва\n  FROM статуси_рейсів"
    },
    {
      "question_id": "авіакомпанія_gen_004",
      "db_id": "авіакомпанія",
      "question": "Знайдіть 5 співробітників з найвищою зарплатою.",
      "evidence": "",
      "gold_sql": "SELECT прізвище, імя, зарплата FROM персонал ORDER BY зарплата DESC NULLS LAST LIMIT 5;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0010008811950683594,
      "pred_time": 0,
      "execution_match": false,
      "pred_error": "column персонал.прізвіще does not exist\nLINE 3:     SELECT персонал.\"прізвіще\", персонал.\"імя\", персонал.\"по...\n                   ^\nHINT:  Perhaps you meant to reference the column \"персонал.прізвище\".\n",
      "exact_match": false,
      "pred_sql": "SELECT \"прізвіще\", \"імя\", \"по_батькові\", \"зарплата\"\n  FROM (\n    SELECT персонал.\"прізвіще\", персонал.\"імя\", персонал.\"по_батькові\", персонал.\"зарплата\",\n    DENSE_RANK() OVER (ORDER BY персонал.\"зарплата\" DESC) AS salary_rank\n    FROM персонал\n  ) AS subquery\n  WHERE salary_rank <= 5;"
    },
    {
      "question_id": "авіакомпанія_gen_005",
      "db_id": "авіакомпанія",
      "question": "Перелічіть рейси, заплановані на завтра, вказавши місто відправлення та місто призначення.",
      "evidence": "",
      "gold_sql": "SELECT r.номер_рейсу, a1.місто AS місто_відправлення, a2.місто AS місто_призначення, r.дата_час_відправлення FROM рейси r JOIN маршрути m ON r.маршрут_id = m.id JOIN аеропорти a1 ON m.аеропорт_відправлення_id = a1.id JOIN аеропорти a2 ON m.аеропорт_призначення_id = a2.id WHERE r.дата_час_відправлення >= current_date + interval '1 day' AND r.дата_час_відправлення < current_date + interval '2 days' ORDER BY r.дата_час_відправлення;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.004003763198852539,
      "pred_time": 0.0030024051666259766,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT T3.місто AS місто_відправлення, T4.місто AS місто_призначення\n  FROM рейси AS T1\n  INNER JOIN маршрути AS T2\n  ON T1.маршрут_id = T2.id\n  INNER JOIN аеропорти AS T3\n  ON T2.аеропорт_відправлення_id = T3.id\n  INNER JOIN аеропорти AS T4\n  ON T2.аеропорт_призначення_id = T4.id\n  WHERE T1.дата_час_відправлення::date = (CURRENT_DATE + INTERVAL '1 day')"
    },
    {
      "question_id": "авіакомпанія_gen_006",
      "db_id": "авіакомпанія",
      "question": "Розрахуйте середню вартість бронювання для кожного класу обслуговування.",
      "evidence": "",
      "gold_sql": "SELECT ko.назва, AVG(b.загальна_вартість) AS середня_вартість FROM бронювання b JOIN класи_обслуговування ko ON b.клас_обслуговування_id = ko.id GROUP BY ko.назва;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.002001523971557617,
      "pred_time": 0.0009999275207519531,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT T2.\"назва\", AVG(T1.\"загальна_вартість\") AS average_cost\n  FROM бронювання AS T1\n  INNER JOIN класи_обслуговування AS T2\n  ON T1.\"клас_обслуговування_id\" = T2.\"id\"\n  GROUP BY T2.\"назва\""
    },
    {
      "question_id": "авіакомпанія_gen_007",
      "db_id": "авіакомпанія",
      "question": "Визначте 3 найзавантаженіші маршрути за кількістю виконаних рейсів за останні 6 місяців.",
      "evidence": "",
      "gold_sql": "SELECT a1.місто AS місто_відправлення, a2.місто AS місто_призначення, COUNT(r.id) AS кількість_рейсів FROM рейси r JOIN маршрути m ON r.маршрут_id = m.id JOIN аеропорти a1 ON m.аеропорт_відправлення_id = a1.id JOIN аеропорти a2 ON m.аеропорт_призначення_id = a2.id JOIN статуси_рейсів sr ON r.статус_id = sr.id WHERE sr.назва = 'Виконано' AND r.дата_час_відправлення >= CURRENT_DATE - INTERVAL '6 months' GROUP BY a1.місто, a2.місто ORDER BY кількість_рейсів DESC LIMIT 3;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0020017623901367188,
      "pred_time": 0.0020029544830322266,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT T2.*\n  FROM (\n    SELECT T1.маршрут_id, COUNT(*) AS count\n      FROM рейси AS T1\n      WHERE T1.дата_час_відправлення > (CURRENT_DATE - INTERVAL '6 months')\n      GROUP BY T1.маршрут_id\n      ORDER BY count DESC\n      LIMIT 3\n  ) AS T3\n  INNER JOIN маршрути AS T2\n  ON T2.id = T3.маршрут_id"
    },
    {
      "question_id": "авіакомпанія_gen_008",
      "db_id": "авіакомпанія",
      "question": "Знайдіть пасажирів, які бронювали рейси як у бізнес-, так і в економ-класі за останній рік.",
      "evidence": "",
      "gold_sql": "WITH PassengerBookings AS ( SELECT bp.пасажир_id, ko.назва AS клас_обслуговування FROM бронювання b JOIN бронювання_пасажири bp ON b.id = bp.бронювання_id JOIN класи_обслуговування ko ON b.клас_обслуговування_id = ko.id JOIN рейси r ON b.рейс_id = r.id WHERE r.дата_час_відправлення >= CURRENT_DATE - INTERVAL '1 year' AND ko.назва IN ('Бізнес', 'Економ') GROUP BY bp.пасажир_id, ko.назва ) SELECT p.прізвище, p.імя FROM пасажири p JOIN PassengerBookings pb ON p.id = pb.пасажир_id GROUP BY p.id, p.прізвище, p.імя HAVING COUNT(DISTINCT pb.клас_обслуговування) = 2;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.003001689910888672,
      "pred_time": 0.0030035972595214844,
      "execution_match": false,
      "exact_match": false,
      "pred_sql": "SELECT T1.*\nFROM пасажири AS T1\nWHERE T1.id IN (\n  SELECT T2.пасажир_id\n  FROM бронювання_пасажири AS T2\n  INNER JOIN бронювання AS T3\n  ON T2.бронювання_id = T3.id\n  WHERE T3.дата_бронювання >= NOW() - INTERVAL '1 year'\n  AND T3.клас_обслуговування_id IN (1, 3)\n)"
    },
    {
      "question_id": "авіакомпанія_gen_009",
      "db_id": "авіакомпанія",
      "question": "Які літаки проходили технічне обслуговування типу 'Капітальний ремонт'?",
      "evidence": "",
      "gold_sql": "SELECT DISTINCT l.реєстраційний_номер FROM літаки l JOIN технічне_обслуговування t ON l.id = t.літак_id WHERE t.тип_обслуговування = 'Капітальний ремонт';",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.002002239227294922,
      "pred_time": 0.0020017623901367188,
      "execution_match": false,
      "exact_match": false,
      "pred_sql": "SELECT T1.реєстраційний_номер, T1.серійний_номер\n  FROM літаки AS T1\n  INNER JOIN технічне_обслуговування AS T2\n  ON T1.id = T2.літак_id\n  WHERE T2.тип_обслуговування = 'Капітальний ремонт'"
    },
    {
      "question_id": "авіакомпанія_gen_010",
      "db_id": "авіакомпанія",
      "question": "Скільки пасажирів скористалися послугою 'Додатковий багаж'?",
      "evidence": "",
      "gold_sql": "SELECT COUNT(DISTINCT bp.пасажир_id) FROM надані_послуги np JOIN послуги p ON np.послуга_id = p.id JOIN бронювання b ON np.бронювання_id = b.id JOIN бронювання_пасажири bp ON b.id = bp.бронювання_id WHERE p.назва = 'Додатковий багаж';",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0010013580322265625,
      "pred_time": 0.0010006427764892578,
      "execution_match": false,
      "exact_match": false,
      "pred_sql": "SELECT COUNT(DISTINCT \"бронювання_id\")\n  FROM \"надані_послуги\"\n  WHERE \"послуга_id\" IN (\n    SELECT \"id\"\n    FROM \"послуги\"\n    WHERE \"назва\" = 'Додатковий багаж'\n  )"
    },
    {
      "question_id": "авіакомпанія_gen_011",
      "db_id": "авіакомпанія",
      "question": "Знайдіть персонал, який виконував роль 'Капітан' на рейсах за останній місяць.",
      "evidence": "",
      "gold_sql": "SELECT DISTINCT p.прізвище, p.імя FROM персонал p JOIN рейси_персонал rp ON p.id = rp.персонал_id JOIN рейси r ON rp.рейс_id = r.id WHERE rp.роль = 'Капітан' AND r.дата_час_відправлення >= CURRENT_DATE - INTERVAL '1 month';",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.002001523971557617,
      "pred_time": 0.002001047134399414,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT T1.*\n  FROM персонал AS T1\n  INNER JOIN рейси_персонал AS T2\n  ON T1.id = T2.персонал_id\n  INNER JOIN рейси AS T3\n  ON T2.рейс_id = T3.id\n  WHERE T2.роль = 'Капітан'\n  AND T3.дата_час_відправлення > (CURRENT_DATE - INTERVAL '1 month')"
    },
    {
      "question_id": "авіакомпанія_gen_012",
      "db_id": "авіакомпанія",
      "question": "Яка середня тривалість технічного обслуговування для кожного типу літака?",
      "evidence": "",
      "gold_sql": "SELECT tl.назва AS тип_літака, AVG(t.дата_завершення - t.дата_початку) AS середня_тривалість_днів FROM технічне_обслуговування t JOIN літаки l ON t.літак_id = l.id JOIN типи_літаків tl ON l.тип_літака_id = tl.id WHERE t.дата_завершення IS NOT NULL AND t.дата_початку IS NOT NULL AND t.дата_завершення >= t.дата_початку GROUP BY tl.назва;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0010008811950683594,
      "pred_time": 0.0,
      "execution_match": false,
      "exact_match": false,
      "pred_sql": "SELECT \n  T3.\"назва\",\n  T2.average_duration\nFROM (\n  SELECT \n    T2.\"тип_літака_id\",\n    AVG(T1.duration) AS average_duration\n  FROM (\n    SELECT \n      T1.\"літак_id\",\n      T1.\"тип_обслуговування\",\n      T1.\"дата_початку\",\n      T1.\"дата_завершення\",\n      (T1.\"дата_завершення\" - T1.\"дата_початку\") AS duration\n    FROM технічне_обслуговування AS T1\n  ) AS T1\n  INNER JOIN літаки AS T2\n  ON T1.\"літак_id\" = T2.\"id\"\n  GROUP BY T2.\"тип_літака_id\"\n) AS T2\nINNER JOIN типи_літаків AS T3\nON T2.\"тип_літака_id\" = T3.\"id\""
    },
    {
      "question_id": "авіакомпанія_gen_013",
      "db_id": "авіакомпанія",
      "question": "Визначте найпопулярніший метод оплати бронювань.",
      "evidence": "",
      "gold_sql": "SELECT mo.назва, COUNT(b.id) AS кількість_бронювань FROM бронювання b JOIN методи_оплати mo ON b.метод_оплати_id = mo.id GROUP BY mo.назва ORDER BY кількість_бронювань DESC LIMIT 1;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0010023117065429688,
      "pred_time": 0.0009999275207519531,
      "execution_match": false,
      "exact_match": false,
      "pred_sql": "SELECT T1.\"метод_оплати_id\", T2.\"назва\", COUNT(*) AS count\n  FROM бронювання AS T1\n  INNER JOIN методи_оплати AS T2\n  ON T1.\"метод_оплати_id\" = T2.\"id\"\n  GROUP BY T1.\"метод_оплати_id\", T2.\"назва\"\n  ORDER BY count DESC\n  LIMIT 1"
    },
    {
      "question_id": "авіакомпанія_gen_014",
      "db_id": "авіакомпанія",
      "question": "Перелічіть усі послуги, доступні для пасажирів першого класу.",
      "evidence": "",
      "gold_sql": "SELECT назва, вартість FROM послуги WHERE доступність_в_класах LIKE '%перший клас%';",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0010006427764892578,
      "pred_time": 0.0,
      "execution_match": false,
      "exact_match": false,
      "pred_sql": "SELECT назва\n  FROM послуги\n  WHERE доступність_в_класах LIKE '%перший клас%'"
    },
    {
      "question_id": "авіакомпанія_gen_015",
      "db_id": "авіакомпанія",
      "question": "Для кожного аеропорту порахуйте кількість відправлень та прибуттів за останній рік.",
      "evidence": "",
      "gold_sql": "WITH AirportFlights AS ( SELECT m.аеропорт_відправлення_id AS airport_id, 'відправлення' AS type FROM рейси r JOIN маршрути m ON r.маршрут_id = m.id WHERE r.дата_час_відправлення >= CURRENT_DATE - INTERVAL '1 year' AND r.статус_id IN (SELECT id FROM статуси_рейсів WHERE назва = 'Виконано') UNION ALL SELECT m.аеропорт_призначення_id AS airport_id, 'прибуття' AS type FROM рейси r JOIN маршрути m ON r.маршрут_id = m.id WHERE r.дата_час_прибуття >= CURRENT_DATE - INTERVAL '1 year' AND r.статус_id IN (SELECT id FROM статуси_рейсів WHERE назва = 'Виконано') ) SELECT a.назва, a.місто, SUM(CASE WHEN af.type = 'відправлення' THEN 1 ELSE 0 END) AS кількість_відправлень, SUM(CASE WHEN af.type = 'прибуття' THEN 1 ELSE 0 END) AS кількість_прибуттів FROM AirportFlights af JOIN аеропорти a ON af.airport_id = a.id GROUP BY a.id, a.назва, a.місто ORDER BY кількість_відправлень DESC, кількість_прибуттів DESC;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0010008811950683594,
      "pred_time": 0,
      "execution_match": false,
      "pred_error": "column t4.відправлення_аеропорт_id does not exist\nLINE 14:   ON T4.відправлення_аеропорт_id = T2.id\n              ^\n",
      "exact_match": false,
      "pred_sql": "SELECT \n  T2.\"код_іата\", \n  COALESCE(T1.departures, 0) AS departures,\n  COALESCE(T3.arrivals, 0) AS arrivals\nFROM аеропорти AS T2\nLEFT JOIN (\n  SELECT \n    T2.\"код_іата\", \n    COUNT(*) AS departures\n  FROM рейси AS T1\n  INNER JOIN маршрути AS T4\n  ON T1.маршрут_id = T4.id\n  INNER JOIN аеропорти AS T2\n  ON T4.відправлення_аеропорт_id = T2.id\n  WHERE T1.дата_час_відправлення BETWEEN (CURRENT_DATE - INTERVAL '1 year') AND CURRENT_DATE\n  GROUP BY T2.\"код_іата\"\n) AS T1\nON T2.\"код_іата\" = T1.\"код_іата\"\nLEFT JOIN (\n  SELECT \n    T2.\"код_іата\", \n    COUNT(*) AS arrivals\n  FROM рейси AS T1\n  INNER JOIN маршрути AS T4\n  ON T1.маршрут_id = T4.id\n  INNER JOIN аеропорти AS T2\n  ON T4.прибуття_аеропорт_id = T2.id\n  WHERE T1.дата_час_прибуття BETWEEN (CURRENT_DATE - INTERVAL '1 year') AND CURRENT_DATE\n  GROUP BY T2.\"код_іата\"\n) AS T3\nON T2.\"код_іата\" = T3.\"код_іата\""
    },
    {
      "question_id": "лікарня_gen_001",
      "db_id": "лікарня",
      "question": "Скільки пацієнтів зареєстровано у лікарні?",
      "evidence": "",
      "gold_sql": "SELECT COUNT(*) FROM пацієнти;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.001001119613647461,
      "pred_time": 0.0010013580322265625,
      "execution_match": true,
      "exact_match": true,
      "pred_sql": "SELECT COUNT(*) \nFROM пацієнти"
    },
    {
      "question_id": "лікарня_gen_002",
      "db_id": "лікарня",
      "question": "Перелічіть назви всіх відділень лікарні.",
      "evidence": "",
      "gold_sql": "SELECT назва FROM відділення WHERE активне = TRUE;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0010013580322265625,
      "pred_time": 0.0,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT назва\nFROM відділення"
    },
    {
      "question_id": "лікарня_gen_003",
      "db_id": "лікарня",
      "question": "Знайдіть персонал за прізвищем 'Петренко'.",
      "evidence": "",
      "gold_sql": "SELECT імя, прізвище, табельний_номер FROM персонал WHERE прізвище = 'Петренко';",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.002001523971557617,
      "pred_time": 0,
      "execution_match": false,
      "pred_error": "unterminated quoted string at or near \"';\"\nLINE 3:   WHERE \"прізвище\" = 'Петренко';\n                                      ^\n",
      "exact_match": false,
      "pred_sql": "SELECT ім'я, по_батькові, дата_народження, телефон, адреса\n  FROM персонал\n  WHERE \"прізвище\" = 'Петренко';"
    },
    {
      "question_id": "лікарня_gen_004",
      "db_id": "лікарня",
      "question": "Які медикаменти є рецептурними?",
      "evidence": "",
      "gold_sql": "SELECT назва, виробник FROM медикаменти WHERE рецептурний = TRUE;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.001001119613647461,
      "pred_time": 0.0010008811950683594,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT назва, назва_міжнародна, виробник, форма_випуску, дозування\n  FROM медикаменти\n  WHERE рецептурний = True"
    },
    {
      "question_id": "лікарня_gen_005",
      "db_id": "лікарня",
      "question": "Скільки лікарів мають спеціалізацію 'Хірургія'?",
      "evidence": "",
      "gold_sql": "SELECT COUNT(DISTINCT сл.лікар_ід) FROM спеціалізації_лікарів сл JOIN спеціалізації с ON сл.спеціалізація_ід = с.ід WHERE с.назва = 'Хірургія';",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0020017623901367188,
      "pred_time": 0.002002239227294922,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT COUNT(DISTINCT лікар_ід)\n  FROM спеціалізації_лікарів\n  WHERE спеціалізація_ід = (\n    SELECT ід\n    FROM спеціалізації\n    WHERE назва = 'Хірургія'\n  )"
    },
    {
      "question_id": "лікарня_gen_006",
      "db_id": "лікарня",
      "question": "Знайдіть пацієнтів з групою крові 'A+' (II+).",
      "evidence": "",
      "gold_sql": "SELECT імя, прізвище, дата_народження FROM пацієнти WHERE група_крові = 'A' AND резус_фактор = '+';",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0,
      "pred_time": 0.0,
      "execution_match": false,
      "exact_match": false,
      "pred_sql": "SELECT прізвище, імя, по_батькові\n  FROM пацієнти\n  WHERE група_крові = 'A (II)'"
    },
    {
      "question_id": "лікарня_gen_007",
      "db_id": "лікарня",
      "question": "Які візити були скасовані за останній тиждень?",
      "evidence": "",
      "gold_sql": "SELECT в.ід, п.прізвище AS пацієнт, пер.прізвище AS лікар, в.дата_час FROM візити в JOIN пацієнти п ON в.пацієнт_ід = п.ід JOIN персонал пер ON в.лікар_ід = пер.ід WHERE в.статус = 'скасований' AND в.дата_час >= CURRENT_DATE - INTERVAL '7 days';",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0030024051666259766,
      "pred_time": 0.0010018348693847656,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT *\n  FROM візити\n  WHERE дата_час > (CURRENT_DATE - INTERVAL '7 days')"
    },
    {
      "question_id": "лікарня_gen_008",
      "db_id": "лікарня",
      "question": "Порахуйте середню зарплату для кожної категорії персоналу.",
      "evidence": "",
      "gold_sql": "SELECT пп.категорія, AVG(п.зарплата) AS середня_зарплата FROM персонал п JOIN посади_персоналу пп ON п.посада_ід = пп.ід WHERE п.активний = TRUE GROUP BY пп.категорія;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0010006427764892578,
      "pred_time": 0.001001119613647461,
      "execution_match": false,
      "exact_match": false,
      "pred_sql": "SELECT \"категорія\", AVG(\"зарплата\") AS average_salary\n  FROM персонал\n  GROUP BY \"категорія\""
    },
    {
      "question_id": "лікарня_gen_009",
      "db_id": "лікарня",
      "question": "Перелічіть діагнози, встановлені пацієнту з ID 123.",
      "evidence": "",
      "gold_sql": "SELECT х.назва, д.дата_встановлення, пер.прізвище AS лікар FROM діагнози д JOIN хвороби х ON д.хвороба_ід = х.ід JOIN персонал пер ON д.лікар_ід = пер.ід WHERE д.пацієнт_ід = 123 ORDER BY д.дата_встановлення DESC;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.003002643585205078,
      "pred_time": 0.0010006427764892578,
      "execution_match": false,
      "exact_match": false,
      "pred_sql": "SELECT \n  CASE \n    WHEN EXISTS (SELECT 1 FROM діагнози WHERE пацієнт_ід = 123) \n    THEN (SELECT string_agg(опис, ', ') FROM діагнози WHERE пацієнт_ід = 123)\n    ELSE 'Пацієнт не існує'\n  END AS result"
    },
    {
      "question_id": "лікарня_gen_010",
      "db_id": "лікарня",
      "question": "Знайдіть 5 найдорожчих медичних послуг.",
      "evidence": "",
      "gold_sql": "SELECT назва, ціна FROM послуги ORDER BY ціна DESC NULLS LAST LIMIT 5;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0010001659393310547,
      "pred_time": 0.0010020732879638672,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT назва, ціна\n  FROM послуги\n  ORDER BY ціна DESC\n  LIMIT 5"
    },
    {
      "question_id": "лікарня_gen_011",
      "db_id": "лікарня",
      "question": "Для кожного відділення знайдіть кількість госпіталізацій за останній місяць.",
      "evidence": "",
      "gold_sql": "SELECT в.назва, COUNT(г.ід) AS кількість_госпіталізацій FROM відділення в LEFT JOIN госпіталізації г ON в.ід = г.відділення_ід AND г.дата_надходження >= CURRENT_DATE - INTERVAL '1 month' WHERE в.активне = TRUE GROUP BY в.назва ORDER BY кількість_госпіталізацій DESC;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.002001523971557617,
      "pred_time": 0.0020020008087158203,
      "execution_match": false,
      "exact_match": false,
      "pred_sql": "SELECT T1.ід, T1.назва, COUNT(T2.ід) AS кількість_госпіталізацій\n  FROM відділення AS T1\n  LEFT JOIN госпіталізації AS T2\n  ON T1.ід = T2.відділення_ід\n  WHERE T2.дата_надходження >= (CURRENT_DATE - INTERVAL '1 month')\n  GROUP BY T1.ід, T1.назва;"
    },
    {
      "question_id": "лікарня_gen_012",
      "db_id": "лікарня",
      "question": "Знайдіть лікарів, які виписали найбільше рецептів за останній квартал.",
      "evidence": "",
      "gold_sql": "SELECT п.імя, п.прізвище, COUNT(р.ід) AS кількість_рецептів FROM персонал п JOIN рецепти р ON п.ід = р.лікар_ід WHERE р.дата_виписки >= CURRENT_DATE - INTERVAL '3 months' GROUP BY п.ід, п.імя, п.прізвище ORDER BY кількість_рецептів DESC LIMIT 10;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0020020008087158203,
      "pred_time": 0.003003358840942383,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT \n  T2.прізвище,\n  T2.імя,\n  T2.по_батькові\nFROM \n  лікарі AS T2\nWHERE \n  T2.ід IN (\n    SELECT \n      T1.лікар_ід\n    FROM \n      рецепти AS T1\n    WHERE \n      T1.дійсний_до BETWEEN (CURRENT_DATE - INTERVAL '3 months') AND CURRENT_DATE\n    GROUP BY \n      T1.лікар_ід\n    ORDER BY \n      COUNT(*) DESC\n    LIMIT 1\n  )"
    },
    {
      "question_id": "лікарня_gen_013",
      "db_id": "лікарня",
      "question": "Визначте середню тривалість госпіталізації для пацієнтів з хворобою 'Пневмонія'.",
      "evidence": "",
      "gold_sql": "SELECT AVG(EXTRACT(DAY FROM (г.дата_виписки - г.дата_надходження))) AS середня_тривалість_днів FROM госпіталізації г JOIN діагнози д ON г.діагноз_ід = д.ід JOIN хвороби х ON д.хвороба_ід = х.ід WHERE х.назва = 'Пневмонія' AND г.дата_виписки IS NOT NULL AND г.дата_надходження IS NOT NULL;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0020020008087158203,
      "pred_time": 0.003002643585205078,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT AVG(EXTRACT(DAY FROM (T1.дата_виписки - T1.дата_надходження)))\n  FROM госпіталізації AS T1\n  INNER JOIN діагнози AS T2\n  ON T1.пацієнт_ід = T2.пацієнт_ід\n  INNER JOIN хвороби AS T3\n  ON T2.хвороба_ід = T3.ід\n  WHERE T3.назва = 'Пневмонія'"
    },
    {
      "question_id": "лікарня_gen_014",
      "db_id": "лікарня",
      "question": "Знайдіть пацієнтів, які мали візити до кардіолога та невролога.",
      "evidence": "",
      "gold_sql": "WITH PatientVisits AS ( SELECT в.пацієнт_ід, с.назва AS спеціалізація FROM візити в JOIN персонал п ON в.лікар_ід = п.ід JOIN спеціалізації_лікарів сл ON п.ід = сл.лікар_ід JOIN спеціалізації с ON сл.спеціалізація_ід = с.ід WHERE с.назва IN ('Кардіологія', 'Неврологія') ) SELECT п.прізвище, п.імя FROM пацієнти п JOIN PatientVisits pv ON п.ід = pv.пацієнт_ід GROUP BY п.ід, п.прізвище, п.імя HAVING COUNT(DISTINCT pv.спеціалізація) = 2;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.003002643585205078,
      "pred_time": 0.0020020008087158203,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT T1.прізвище, T1.імя, T1.по_батькові\n  FROM пацієнти AS T1\n  INNER JOIN (\n    SELECT T2.пацієнт_ід\n      FROM візити AS T2\n      INNER JOIN лікарі AS T3\n      ON T2.лікар_ід = T3.ід\n      WHERE T3.спеціалізація IN ('Кардіологія', 'Неврологія')\n      GROUP BY T2.пацієнт_ід\n      HAVING COUNT(DISTINCT T3.спеціалізація) = 2\n  ) AS T4\n  ON T1.ід = T4.пацієнт_ід"
    },
    {
      "question_id": "лікарня_gen_015",
      "db_id": "лікарня",
      "question": "Порахуйте загальну суму наданих платних послуг за минулий місяць для кожної страхової компанії.",
      "evidence": "",
      "gold_sql": "SELECT ск.назва, SUM(пос.ціна) AS загальна_сума FROM надані_послуги нп JOIN послуги пос ON нп.послуга_ід = пос.ід JOIN пацієнти п ON нп.пацієнт_ід = п.ід JOIN страховки_пацієнтів сп ON п.ід = сп.пацієнт_ід JOIN страхові_компанії ск ON сп.страхова_компанія_ід = ск.ід WHERE нп.дата_час >= date_trunc('month', CURRENT_DATE - interval '1 month') AND нп.дата_час < date_trunc('month', CURRENT_DATE) AND пос.ціна > 0 AND сп.активна = TRUE GROUP BY ск.назва ORDER BY загальна_сума DESC;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.004003047943115234,
      "pred_time": 0.003003358840942383,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT \n  T3.\"назва\" AS insurance_company,\n  SUM(T1.\"сума\") AS total_sum\nFROM \n  оплати AS T1\n  INNER JOIN страховки_пацієнтів AS T2\n    ON T1.\"страховка_ід\" = T2.\"ід\"\n  INNER JOIN страхові_компанії AS T3\n    ON T2.\"страхова_компанія_ід\" = T3.\"ід\"\nWHERE \n  EXTRACT(MONTH FROM T1.\"дата_час\") = EXTRACT(MONTH FROM CURRENT_DATE) - 1\n  AND EXTRACT(YEAR FROM T1.\"дата_час\") = EXTRACT(YEAR FROM CURRENT_DATE)\nGROUP BY \n  T3.\"назва\""
    },
    {
      "question_id": "ресторан_gen_001",
      "db_id": "ресторан",
      "question": "Скільки страв є вегетаріанськими?",
      "evidence": "",
      "gold_sql": "SELECT COUNT(*) FROM страви WHERE вегетаріанська = TRUE;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0010008811950683594,
      "pred_time": 0.0020020008087158203,
      "execution_match": true,
      "exact_match": true,
      "pred_sql": "SELECT COUNT(*)\n  FROM страви\n  WHERE вегетаріанська = True"
    },
    {
      "question_id": "ресторан_gen_002",
      "db_id": "ресторан",
      "question": "Перелічіть назви всіх категорій страв.",
      "evidence": "",
      "gold_sql": "SELECT назва FROM категорії WHERE активна = TRUE;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0010008811950683594,
      "pred_time": 0.0010008811950683594,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT назва\n  FROM категорії"
    },
    {
      "question_id": "ресторан_gen_003",
      "db_id": "ресторан",
      "question": "Знайдіть персонал за прізвищем 'Іваненко'.",
      "evidence": "",
      "gold_sql": "SELECT імя, прізвище, телефон FROM персонал WHERE прізвище = 'Іваненко' AND активний = TRUE;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0010023117065429688,
      "pred_time": 0.0020003318786621094,
      "execution_match": false,
      "exact_match": false,
      "pred_sql": "SELECT *\n  FROM персонал\n  WHERE прізвище = 'Іваненко'"
    },
    {
      "question_id": "ресторан_gen_004",
      "db_id": "ресторан",
      "question": "Які столики розраховані на 4 місця?",
      "evidence": "",
      "gold_sql": "SELECT номер, розташування FROM столики WHERE кількість_місць = 4 AND активний = TRUE;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.001001119613647461,
      "pred_time": 0.001001119613647461,
      "execution_match": false,
      "exact_match": false,
      "pred_sql": "SELECT номер\n  FROM столики\n  WHERE кількість_місць = 4"
    },
    {
      "question_id": "ресторан_gen_005",
      "db_id": "ресторан",
      "question": "Які інгредієнти є алергенами?",
      "evidence": "",
      "gold_sql": "SELECT назва, опис FROM інгредієнти WHERE алерген = TRUE;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.001001119613647461,
      "pred_time": 0.0010004043579101562,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT назва\n  FROM інгредієнти\n  WHERE алерген = TRUE"
    },
    {
      "question_id": "ресторан_gen_006",
      "db_id": "ресторан",
      "question": "Знайдіть страви дорожчі за 200.",
      "evidence": "",
      "gold_sql": "SELECT назва, ціна FROM страви WHERE ціна > 200 AND активна = TRUE;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0010008811950683594,
      "pred_time": 0.0,
      "execution_match": false,
      "exact_match": false,
      "pred_sql": "SELECT назва\n  FROM страви\n  WHERE ціна > 200\n  AND ціна IS NOT NULL"
    },
    {
      "question_id": "ресторан_gen_007",
      "db_id": "ресторан",
      "question": "Які замовлення обслуговував офіціант 'Петро Сидоренко'?",
      "evidence": "",
      "gold_sql": "SELECT з.ід, з.дата_час, з.фінальна_сума FROM замовлення з JOIN персонал п ON з.офіціант_ід = п.ід WHERE п.імя = 'Петро' AND п.прізвище = 'Сидоренко';",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.003002166748046875,
      "pred_time": 0.003003358840942383,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT T1.*\n  FROM замовлення AS T1\n  WHERE T1.офіціант_ід = (\n    SELECT ід\n    FROM персонал\n    WHERE імя = 'Петро' AND по_батькові = 'Сидоренко'\n  )"
    },
    {
      "question_id": "ресторан_gen_008",
      "db_id": "ресторан",
      "question": "Яка середня вартість страв у категорії 'Десерти'?",
      "evidence": "",
      "gold_sql": "SELECT AVG(с.ціна) FROM страви с JOIN категорії к ON с.категорія_ід = к.ід WHERE к.назва = 'Десерти' AND с.активна = TRUE;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0010006427764892578,
      "pred_time": 0.0010008811950683594,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT AVG(T2.ціна)\n  FROM категорії AS T1\n  INNER JOIN страви AS T2\n  ON T1.ід = T2.категорія_ід\n  WHERE T1.назва = 'Десерти'"
    },
    {
      "question_id": "ресторан_gen_009",
      "db_id": "ресторан",
      "question": "Знайдіть резервації на сьогоднішній вечір (після 18:00).",
      "evidence": "",
      "gold_sql": "SELECT р.ід, с.номер AS столик, р.прізвище_клієнта, р.телефон_клієнта, р.час_початку FROM резервації р JOIN столики с ON р.столик_ід = с.ід JOIN статуси_резервацій ст ON р.статус_ід = ст.ід WHERE р.дата = CURRENT_DATE AND р.час_початку >= '18:00:00' AND ст.назва = 'Підтверджено';",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.002002239227294922,
      "pred_time": 0.0010004043579101562,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT *\n  FROM резервації\n  WHERE дата = CURRENT_DATE\n  AND час_початку >= '18:00:00'"
    },
    {
      "question_id": "ресторан_gen_010",
      "db_id": "ресторан",
      "question": "Скільки інгредієнтів постачає постачальник 'Продукти Плюс'?",
      "evidence": "",
      "gold_sql": "SELECT COUNT(i.ід) FROM інгредієнти i JOIN постачальники p ON i.постачальник_ід = p.ід WHERE p.назва = 'Продукти Плюс' AND i.активний = TRUE;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0010013580322265625,
      "pred_time": 0.0010008811950683594,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT COUNT(T2.ід)\n  FROM постачальники AS T1\n  INNER JOIN інгредієнти AS T2\n  ON T1.ід = T2.постачальник_ід\n  WHERE T1.назва = 'Продукти Плюс'"
    },
    {
      "question_id": "ресторан_gen_011",
      "db_id": "ресторан",
      "question": "Визначте 5 найпопулярніших страв за кількістю замовлень.",
      "evidence": "",
      "gold_sql": "SELECT с.назва, COUNT(пз.ід) AS кількість_замовлень FROM страви с JOIN позиції_замовлення пз ON с.ід = пз.страва_ід GROUP BY с.назва, с.ід ORDER BY кількість_замовлень DESC LIMIT 5;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0010006427764892578,
      "pred_time": 0.0010001659393310547,
      "execution_match": false,
      "exact_match": false,
      "pred_sql": "SELECT T1.ід, T1.назва, T2.total_orders\nFROM страви AS T1\nINNER JOIN (\n  SELECT страва_ід, COUNT(*) AS total_orders\n  FROM позиції_замовлення\n  GROUP BY страва_ід\n) AS T2\nON T1.ід = T2.страва_ід\nORDER BY T2.total_orders DESC\nLIMIT 5"
    },
    {
      "question_id": "ресторан_gen_012",
      "db_id": "ресторан",
      "question": "Знайдіть офіціантів, чия середня сума замовлення перевищує 500 за останній місяць.",
      "evidence": "",
      "gold_sql": "SELECT п.імя, п.прізвище, AVG(з.фінальна_сума) AS середня_сума_замовлення FROM персонал п JOIN замовлення з ON п.ід = з.офіціант_ід JOIN посади по ON п.посада_ід = по.ід WHERE по.назва = 'Офіціант' AND з.дата_час >= CURRENT_DATE - INTERVAL '1 month' GROUP BY п.ід, п.імя, п.прізвище HAVING AVG(з.фінальна_сума) > 500;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0020020008087158203,
      "pred_time": 0.001001119613647461,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT T2.прізвище, T2.імя, T2.по_батькові\n  FROM замовлення AS T1\n  INNER JOIN персонал AS T2\n  ON T1.офіціант_ід = T2.ід\n  WHERE T1.дата_час >= (CURRENT_DATE - INTERVAL '1 month')\n  GROUP BY T1.офіціант_ід, T2.прізвище, T2.імя, T2.по_батькові\n  HAVING AVG(T1.фінальна_сума) > 500"
    },
    {
      "question_id": "ресторан_gen_013",
      "db_id": "ресторан",
      "question": "Які інгредієнти потрібно замовити (кількість на складі менше мінімальної)?",
      "evidence": "",
      "gold_sql": "SELECT назва, кількість_на_складі, мінімальна_кількість FROM інгредієнти WHERE кількість_на_складі < мінімальна_кількість AND активний = TRUE;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0,
      "pred_time": 0.0,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT назва, кількість_на_складі, мінімальна_кількість, постачальник_ід\n  FROM інгредієнти\n  WHERE кількість_на_складі < мінімальна_кількість"
    },
    {
      "question_id": "ресторан_gen_014",
      "db_id": "ресторан",
      "question": "Розрахуйте загальну суму чайових за минулий тиждень.",
      "evidence": "",
      "gold_sql": "SELECT SUM(чайові) AS загальні_чайові FROM замовлення WHERE дата_час >= CURRENT_DATE - INTERVAL '7 days' AND статус_ід IN (SELECT ід FROM статуси_замовлень WHERE є_фінальним = TRUE);",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0009999275207519531,
      "pred_time": 0.0020024776458740234,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT SUM(\"чайові\")\n  FROM замовлення\n  WHERE \"дата_час\" >= (CURRENT_DATE - INTERVAL '7 day') AND \"дата_час\" <= CURRENT_DATE"
    },
    {
      "question_id": "ресторан_gen_015",
      "db_id": "ресторан",
      "question": "Знайдіть клієнтів, які робили резервації та не з'явилися.",
      "evidence": "",
      "gold_sql": "SELECT DISTINCT р.прізвище_клієнта, р.імя_клієнта, р.телефон_клієнта FROM резервації р JOIN статуси_резервацій ср ON р.статус_ід = ср.ід WHERE ср.назва = 'Не з''явився';",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0010020732879638672,
      "pred_time": 0,
      "execution_match": false,
      "pred_error": "relation \"відвідування\" does not exist\nLINE 6:       LEFT JOIN відвідування AS T3\n                        ^\n",
      "exact_match": false,
      "pred_sql": "SELECT T1.*\n  FROM клієнти AS T1\n  INNER JOIN (\n    SELECT T2.client_id\n      FROM резервації AS T2\n      LEFT JOIN відвідування AS T3\n      ON T2.client_id = T3.client_id AND T2.visit_id = T3.visit_id\n      WHERE T3.client_id IS NULL\n  ) AS T4\n  ON T1.client_id = T4.client_id"
    },
    {
      "question_id": "спортивклуб_gen_001",
      "db_id": "спортивний_клуб",
      "question": "Скільки активних членів клубу зареєстровано?",
      "evidence": "",
      "gold_sql": "SELECT COUNT(*) FROM члени_клубу WHERE активний = TRUE;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0010004043579101562,
      "pred_time": 0.001001119613647461,
      "execution_match": true,
      "exact_match": true,
      "pred_sql": "SELECT COUNT(*)\n  FROM члени_клубу\n  WHERE \"активний\" = TRUE;"
    },
    {
      "question_id": "спортклуб_gen_002",
      "db_id": "спортивний_клуб",
      "question": "Перелічіть назви всіх типів абонементів.",
      "evidence": "",
      "gold_sql": "SELECT назва FROM типи_абонементів WHERE активний = TRUE;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0010006427764892578,
      "pred_time": 0.0010008811950683594,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT назва\n  FROM типи_абонементів"
    },
    {
      "question_id": "спортклуб_gen_003",
      "db_id": "спортивний_клуб",
      "question": "Знайдіть тренера за прізвищем 'Ковальчук'.",
      "evidence": "",
      "gold_sql": "SELECT імя, прізвище, телефон FROM тренери WHERE прізвище = 'Ковальчук' AND активний = TRUE;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.001001596450805664,
      "pred_time": 0.0010008811950683594,
      "execution_match": false,
      "exact_match": false,
      "pred_sql": "SELECT *\n  FROM тренери\n  WHERE прізвище = 'Коваленко'"
    },
    {
      "question_id": "спортклуб_gen_004",
      "db_id": "спортивний_клуб",
      "question": "Які приміщення є басейнами?",
      "evidence": "",
      "gold_sql": "SELECT п.назва, п.площа FROM приміщення п JOIN типи_приміщень тп ON п.тип_приміщення_id = тп.id WHERE тп.назва = 'Басейн';",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0010004043579101562,
      "pred_time": 0.001001596450805664,
      "execution_match": false,
      "exact_match": false,
      "pred_sql": "SELECT T1.\"назва\"\n  FROM приміщення AS T1\n  WHERE T1.\"тип_приміщення_id\" = (\n    SELECT \"id\"\n    FROM типи_приміщень\n    WHERE \"назва\" = 'Басейн'\n  )"
    },
    {
      "question_id": "спортклуб_gen_005",
      "db_id": "спортивний_клуб",
      "question": "Перелічіть групові заняття з рівнем складності 'Високий'.",
      "evidence": "",
      "gold_sql": "SELECT гз.назва, гз.опис FROM групові_заняття гз JOIN рівні_складності рс ON гз.рівень_складності_id = рс.id WHERE рс.назва = 'Високий';",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0020020008087158203,
      "pred_time": 0.001001596450805664,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT T1.*\n  FROM групові_заняття AS T1\n  INNER JOIN рівні_складності AS T2\n  ON T1.\"рівень_складності_id\" = T2.\"id\"\n  WHERE T2.\"назва\" = 'Високий'"
    },
    {
      "question_id": "спортклуб_gen_006",
      "db_id": "спортивний_клуб",
      "question": "Які тренери спеціалізуються на йозі?",
      "evidence": "",
      "gold_sql": "SELECT т.імя, т.прізвище FROM тренери т JOIN спеціалізації_тренерів ст ON т.спеціалізація_id = ст.id WHERE ст.назва = 'Йога' AND т.активний = TRUE;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0010006427764892578,
      "pred_time": 0,
      "execution_match": false,
      "pred_error": "syntax error at or near \"з\"\nLINE 6:       WHERE назва ILIKE 'Тренер з йозі' OR назва ILIKE 'Трен...\n                                        ^\n",
      "exact_match": false,
      "pred_sql": "SELECT прізвище, ім'я, по_батькові\n  FROM тренери\n  WHERE спеціалізація_id IN (\n    SELECT id\n      FROM спеціалізації_тренерів\n      WHERE назва ILIKE 'Тренер з йозі' OR назва ILIKE 'Тренер з йоги'\n  )"
    },
    {
      "question_id": "спортклуб_gen_007",
      "db_id": "спортивний_клуб",
      "question": "Знайдіть членів клубу, чиє членство закінчується цього місяця.",
      "evidence": "",
      "gold_sql": "SELECT чк.імя, чк.прізвище, ч.дата_завершення FROM члени_клубу чк JOIN членства ч ON чк.членство_id = ч.id WHERE ч.дата_завершення >= date_trunc('month', CURRENT_DATE) AND ч.дата_завершення < date_trunc('month', CURRENT_DATE) + interval '1 month';",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.002001047134399414,
      "pred_time": 0.001001119613647461,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT T1.\"прізвище\", T1.\"імя\", T1.\"по_батькові\"\n  FROM члени_клубу AS T1\n  INNER JOIN членства AS T2\n  ON T1.\"членство_id\" = T2.\"id\"\n  WHERE EXTRACT(MONTH FROM T2.\"дата_завершення\") = EXTRACT(MONTH FROM CURRENT_DATE)\n  AND EXTRACT(YEAR FROM T2.\"дата_завершення\") = EXTRACT(YEAR FROM CURRENT_DATE)"
    },
    {
      "question_id": "спортклуб_gen_008",
      "db_id": "спортивний_клуб",
      "question": "Яка середня вартість абонементів?",
      "evidence": "",
      "gold_sql": "SELECT AVG(вартість) FROM типи_абонементів WHERE активний = TRUE;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0010004043579101562,
      "pred_time": 0.0,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT AVG(\"вартість\") \nFROM типи_абонементів"
    },
    {
      "question_id": "спортклуб_gen_009",
      "db_id": "спортивний_клуб",
      "question": "Перелічіть обладнання, придбане минулого року.",
      "evidence": "",
      "gold_sql": "SELECT назва, виробник, дата_придбання FROM обладнання WHERE EXTRACT(YEAR FROM дата_придбання) = EXTRACT(YEAR FROM CURRENT_DATE) - 1;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0010013580322265625,
      "pred_time": 0.0010006427764892578,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT *\n  FROM обладнання\n  WHERE дата_придбання BETWEEN CURRENT_DATE - INTERVAL '1 year' AND CURRENT_DATE"
    },
    {
      "question_id": "спортклуб_gen_010",
      "db_id": "спортивний_клуб",
      "question": "Знайдіть платежі, здійснені за допомогою 'Картка'.",
      "evidence": "",
      "gold_sql": "SELECT п.id, чк.прізвище AS член_клубу, п.сума, п.дата_платежу FROM платежі п JOIN члени_клубу чк ON п.член_клубу_id = чк.id WHERE п.спосіб_оплати = 'Картка';",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0009999275207519531,
      "pred_time": 0.0,
      "execution_match": false,
      "exact_match": false,
      "pred_sql": "SELECT id, сума\n  FROM платежі\n  WHERE спосіб_оплати = 'Картка'\n  AND статус = 'Успішний'"
    },
    {
      "question_id": "спортклуб_gen_011",
      "db_id": "спортивний_клуб",
      "question": "Які групові заняття мають найбільшу кількість записів?",
      "evidence": "",
      "gold_sql": "SELECT гз.назва, COUNT(зз.id) AS кількість_записів FROM групові_заняття гз JOIN розклад_занять рз ON гз.id = рз.заняття_id JOIN записи_на_заняття зз ON рз.id = зз.розклад_заняття_id JOIN статуси_записів сз ON зз.статус_id = сз.id WHERE сз.назва = 'Записано' GROUP BY гз.назва ORDER BY кількість_записів DESC LIMIT 5;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.003002166748046875,
      "pred_time": 0.0020017623901367188,
      "execution_match": false,
      "exact_match": false,
      "pred_sql": "SELECT T1.\"назва\"\n  FROM групові_заняття AS T1\n  INNER JOIN розклад_занять AS T2\n  ON T1.\"id\" = T2.\"заняття_id\"\n  INNER JOIN записи_на_заняття AS T3\n  ON T2.\"id\" = T3.\"розклад_заняття_id\"\n  WHERE T3.\"розклад_заняття_id\" IN (\n    SELECT \"розклад_заняття_id\"\n      FROM записи_на_заняття\n      GROUP BY \"розклад_заняття_id\"\n      ORDER BY COUNT(*) DESC\n      LIMIT 1\n  )"
    },
    {
      "question_id": "спортклуб_gen_012",
      "db_id": "спортивний_клуб",
      "question": "Знайдіть тренерів з середньою оцінкою вище 4.5.",
      "evidence": "",
      "gold_sql": "SELECT т.імя, т.прізвище, AVG(о.оцінка) AS середня_оцінка FROM тренери т JOIN оцінки_тренерів о ON т.id = о.тренер_id WHERE т.активний = TRUE GROUP BY т.id, т.імя, т.прізвище HAVING AVG(о.оцінка) > 4.5;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.002002239227294922,
      "pred_time": 0.0,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT T2.\"прізвище\", T2.\"імя\", T2.\"по_батькові\"\n  FROM тренери AS T2\n  INNER JOIN (\n    SELECT T1.\"тренер_id\", AVG(T1.\"оцінка\") AS \"average_rating\"\n      FROM оцінки_тренерів AS T1\n      GROUP BY T1.\"тренер_id\"\n  ) AS T1\n  ON T2.\"id\" = T1.\"тренер_id\"\n  WHERE T1.\"average_rating\" > 4.5"
    },
    {
      "question_id": "спортклуб_gen_013",
      "db_id": "спортивний_клуб",
      "question": "Визначте найпопулярніший день тижня для відвідувань клубу.",
      "evidence": "",
      "gold_sql": "SELECT EXTRACT(ISODOW FROM дата_відвідування) AS день_тижня, COUNT(id) AS кількість_відвідувань FROM відвідування GROUP BY день_тижня ORDER BY кількість_відвідувань DESC LIMIT 1;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0010018348693847656,
      "pred_time": 0.0010006427764892578,
      "execution_match": false,
      "exact_match": false,
      "pred_sql": "SELECT T1.\"день_тижня\" \nFROM розклад_занять AS T1\nJOIN відвідування AS T2 ON T1.id = T2.запис_на_заняття_id\nGROUP BY T1.\"день_тижня\" \nORDER BY COUNT(*) DESC \nLIMIT 1"
    },
    {
      "question_id": "спортклуб_gen_014",
      "db_id": "спортивний_клуб",
      "question": "Знайдіть членів клубу, які відвідували і басейн, і сауну.",
      "evidence": "",
      "gold_sql": "WITH MemberVisits AS ( SELECT в.член_клубу_id, тп.назва AS тип_приміщення FROM відвідування в LEFT JOIN записи_на_заняття зз ON в.запис_на_заняття_id = зз.id LEFT JOIN індивідуальні_бронювання іб ON в.індивідуальне_бронювання_id = іб.id LEFT JOIN розклад_занять рз ON зз.розклад_заняття_id = рз.id LEFT JOIN приміщення п ON рз.приміщення_id = п.id OR іб.приміщення_id = п.id LEFT JOIN типи_приміщень тп ON п.тип_приміщення_id = тп.id WHERE тп.назва IN ('Басейн', 'Сауна') ) SELECT чк.імя, чк.прізвище FROM члени_клубу чк JOIN MemberVisits mv ON чк.id = mv.член_клубу_id WHERE чк.активний = TRUE GROUP BY чк.id, чк.імя, чк.прізвище HAVING COUNT(DISTINCT mv.тип_приміщення) = 2;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0030031204223632812,
      "pred_time": 0.0010008811950683594,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT T1.прізвище, T1.імя, T1.по_батькові \nFROM члени_клубу AS T1 \nWHERE T1.id IN (\n  SELECT член_клубу_id \n  FROM відвідування \n  WHERE запис_на_заняття_id IN (\n    SELECT id \n    FROM приміщення \n    WHERE тип_приміщення_id IN (\n      SELECT id \n      FROM типи_приміщень \n      WHERE назва = 'Басейн' OR назва = 'Сауна'\n    )\n  )\n  GROUP BY член_клубу_id \n  HAVING COUNT(DISTINCT запис_на_заняття_id) = 2\n)"
    },
    {
      "question_id": "спортклуб_gen_015",
      "db_id": "спортивний_клуб",
      "question": "Розрахуйте дохід від кожного типу абонементу за останній рік.",
      "evidence": "",
      "gold_sql": "SELECT та.назва, SUM(п.сума) AS загальний_дохід FROM типи_абонементів та JOIN членства ч ON та.id = ч.тип_абонементу_id JOIN платежі п ON ч.id = п.членство_id WHERE п.дата_платежу >= CURRENT_DATE - INTERVAL '1 year' AND п.статус = 'Оплачено' GROUP BY та.назва ORDER BY загальний_дохід DESC;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.001001119613647461,
      "pred_time": 0.0010001659393310547,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT T2.\"назва\", T1.total_revenue\n  FROM (\n    SELECT T1.\"тип_абонементу_id\", SUM(T2.\"сума\") AS total_revenue\n      FROM членства AS T1\n      INNER JOIN платежі AS T2\n      ON T1.\"id\" = T2.\"членство_id\"\n      WHERE T2.\"дата_платежу\" >= CURRENT_DATE - INTERVAL '1 year'\n      GROUP BY T1.\"тип_абонементу_id\"\n  ) AS T1\n  INNER JOIN типи_абонементів AS T2\n  ON T1.\"тип_абонементу_id\" = T2.\"id\""
    },
    {
      "question_id": "університет_gen_001",
      "db_id": "університет",
      "question": "Скільки студентів навчається на кожному факультеті?",
      "evidence": "",
      "gold_sql": "SELECT T1.назва ,  count(*) FROM факультети AS T1 JOIN кафедри AS T2 ON T1.ід  =  T2.факультет_ід JOIN напрями AS N ON T2.ід = N.кафедра_ід JOIN групи AS T3 ON N.ід  =  T3.напрям_ід JOIN студенти AS T4 ON T3.ід  =  T4.група_ід GROUP BY T1.ід, T1.назва;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.005005359649658203,
      "pred_time": 0,
      "execution_match": false,
      "pred_error": "column t1.ідентифікатор факультету does not exist\nLINE 4:   ON T1.\"ідентифікатор факультету\" = T2.\"ідентифікатор факул...\n             ^\n",
      "exact_match": false,
      "pred_sql": "SELECT T2.\"назва_факультету\", COUNT(*) AS student_count\n  FROM студенти AS T1\n  INNER JOIN факультети AS T2\n  ON T1.\"ідентифікатор факультету\" = T2.\"ідентифікатор факультету\"\n  GROUP BY T2.\"назва_факультету\""
    },
    {
      "question_id": "університет_gen_002",
      "db_id": "університет",
      "question": "Перелічіть усі курси, які викладає викладач з прізвищем 'Мельник'.",
      "evidence": "",
      "gold_sql": "SELECT T2.назва FROM викладачі AS T1 JOIN заняття AS T3 ON T1.ід  =  T3.викладач_ід JOIN курси AS T2 ON T3.курс_ід  =  T2.ід WHERE T1.прізвище  =  'Мельник';",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.004004716873168945,
      "pred_time": 0.0030014514923095703,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT T3.назва\n  FROM викладачі AS T1\n  INNER JOIN заняття AS T2\n  ON T1.ід = T2.викладач_ід\n  INNER JOIN курси AS T3\n  ON T2.курс_ід = T3.ід\n  WHERE T1.прізвище = 'Мельник'"
    },
    {
      "question_id": "університет_gen_003",
      "db_id": "університет",
      "question": "Який середній бал студентів групи 'ПМ-21'?",
      "evidence": "",
      "gold_sql": "SELECT avg(T1.середній_бал) FROM студенти AS T1 JOIN групи AS T2 ON T1.група_ід  =  T2.ід WHERE T2.назва  =  'ПМ-21';",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0020017623901367188,
      "pred_time": 0.0020020008087158203,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT AVG(T1.\"середній_бал\")\n  FROM студенти AS T1\n  INNER JOIN групи AS T2\n  ON T1.\"група_ід\" = T2.\"ід\"\n  WHERE T2.\"назва\" = 'ПМ-21'"
    },
    {
      "question_id": "університет_gen_004",
      "db_id": "університет",
      "question": "Які аудиторії мають проектор та місткість понад 50 осіб?",
      "evidence": "",
      "gold_sql": "SELECT T1.номер ,  T2.назва FROM аудиторії AS T1 JOIN будівлі AS T2 ON T1.будівля_ід  =  T2.ід WHERE T1.має_проектор IS TRUE AND T1.місткість  >  50;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0010013580322265625,
      "pred_time": 0.0010013580322265625,
      "execution_match": false,
      "exact_match": false,
      "pred_sql": "SELECT номер\n  FROM аудиторії\n  WHERE має_проектор = 'True'\n  AND місткість > 50"
    },
    {
      "question_id": "університет_gen_005",
      "db_id": "університет",
      "question": "Знайдіть імена та електронні адреси всіх завідувачів кафедр.",
      "evidence": "",
      "gold_sql": "SELECT T2.прізвище ,  T2.імя ,  T2.електронна_пошта FROM кафедри AS T1 JOIN викладачі AS T2 ON T1.завідувач_ід  =  T2.ід;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.001001119613647461,
      "pred_time": 0.0010004043579101562,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT T2.\"прізвище\", T2.\"імя\", T2.\"електронна_пошта\"\n  FROM кафедри AS T1\n  INNER JOIN викладачі AS T2\n  ON T1.\"завідувач_ід\" = T2.\"ід\""
    },
    {
      "question_id": "університет_gen_006",
      "db_id": "університет",
      "question": "Скільки курсів пропонує кожна кафедра?",
      "evidence": "",
      "gold_sql": "SELECT T1.назва ,  count(T2.ід) FROM кафедри AS T1 JOIN курси AS T2 ON T1.ід  =  T2.кафедра_ід GROUP BY T1.ід, T1.назва;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.001001119613647461,
      "pred_time": 0.0010008811950683594,
      "execution_match": false,
      "exact_match": false,
      "pred_sql": "SELECT T1.ід, T1.назва, COUNT(T2.ід) AS кількість_курсів\n  FROM кафедри AS T1\n  LEFT JOIN курси AS T2\n  ON T1.ід = T2.кафедра_ід\n  GROUP BY T1.ід, T1.назва"
    },
    {
      "question_id": "університет_gen_007",
      "db_id": "університет",
      "question": "Перелічіть студентів, які вступили до університету після 1 вересня 2022 року.",
      "evidence": "",
      "gold_sql": "SELECT прізвище ,  імя FROM студенти WHERE дата_вступу  >  '2022-09-01'",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.001001596450805664,
      "pred_time": 0.0,
      "execution_match": false,
      "exact_match": false,
      "pred_sql": "SELECT студентський_квиток, прізвище, імя, по_батькові\n  FROM студенти\n  WHERE дата_вступу > '2022-09-01'"
    },
    {
      "question_id": "університет_gen_008",
      "db_id": "університет",
      "question": "Які існують типи занять?",
      "evidence": "",
      "gold_sql": "SELECT назва FROM типи_занять",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.001001596450805664,
      "pred_time": 0.0010006427764892578,
      "execution_match": true,
      "exact_match": true,
      "pred_sql": "SELECT назва\n  FROM типи_занять"
    },
    {
      "question_id": "університет_gen_009",
      "db_id": "університет",
      "question": "Знайдіть усіх викладачів з науковим ступенем 'Доктор наук'.",
      "evidence": "",
      "gold_sql": "SELECT T1.прізвище ,  T1.імя FROM викладачі AS T1 JOIN академічні_ступені AS T2 ON T1.науковий_ступінь_ід  =  T2.ід WHERE T2.назва  =  'Доктор наук'",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0009999275207519531,
      "pred_time": 0.0010008811950683594,
      "execution_match": false,
      "exact_match": false,
      "pred_sql": "SELECT *\n  FROM викладачі\n  WHERE науковий_ступінь_ід = 4"
    },
    {
      "question_id": "університет_gen_010",
      "db_id": "університет",
      "question": "Який розклад занять для курсу 'Програмування' у поточному семестрі?",
      "evidence": "",
      "gold_sql": "SELECT T3.день_тижня ,  T3.час_початку ,  T3.час_кінця ,  T5.номер FROM курси AS T1 JOIN заняття AS T2 ON T1.ід  =  T2.курс_ід JOIN розклад_занять AS T3 ON T2.ід  =  T3.заняття_ід JOIN семестри AS T4 ON T2.семестр_ід  =  T4.ід JOIN аудиторії AS T5 ON T3.аудиторія_ід  =  T5.ід WHERE T1.назва  =  'Програмування' AND T4.є_активним IS TRUE;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0020017623901367188,
      "pred_time": 0.0020012855529785156,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT T1.*\n  FROM розклад_занять AS T1\n  INNER JOIN заняття AS T2\n  ON T1.заняття_ід = T2.ід\n  INNER JOIN курси AS T3\n  ON T2.курс_ід = T3.ід\n  INNER JOIN семестри AS T4\n  ON T2.семестр_ід = T4.ід\n  WHERE T3.назва = 'Програмування'\n  AND T4.ід = (\n    SELECT ід\n    FROM семестри\n    WHERE є_активним = TRUE\n  )"
    },
    {
      "question_id": "університет_gen_011",
      "db_id": "університет",
      "question": "Перелічіть усі факультети та імена їхніх деканів.",
      "evidence": "",
      "gold_sql": "SELECT T1.назва ,  T2.прізвище ,  T2.імя FROM факультети AS T1 JOIN викладачі AS T2 ON T1.декан_ід  =  T2.ід;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0,
      "pred_time": 0.0010013580322265625,
      "execution_match": false,
      "exact_match": false,
      "pred_sql": "SELECT T1.назва, T2.прізвище, T2.імя, T2.по_батькові\n  FROM факультети AS T1\n  INNER JOIN викладачі AS T2\n  ON T1.декан_ід = T2.ід"
    },
    {
      "question_id": "університет_gen_012",
      "db_id": "університет",
      "question": "Скільки студентів у кожній групі навчається на бюджетній формі?",
      "evidence": "",
      "gold_sql": "SELECT T1.назва ,  count(T2.ід) FROM групи AS T1 JOIN студенти AS T2 ON T1.ід  =  T2.група_ід WHERE T2.фінансування  =  'Бюджет' GROUP BY T1.ід, T1.назва;",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0010006427764892578,
      "pred_time": 0.0,
      "execution_match": false,
      "exact_match": false,
      "pred_sql": "SELECT T1.ід, T1.назва, COUNT(T2.ід) AS кількість_студентів\n  FROM групи AS T1\n  INNER JOIN студенти AS T2\n  ON T1.ід = T2.група_ід\n  WHERE T2.фінансування = 'бюджет'\n  GROUP BY T1.ід, T1.назва"
    },
    {
      "question_id": "університет_gen_013",
      "db_id": "університет",
      "question": "Знайдіть навчальні матеріали (назву та тип), доступні для курсу 'Математичний аналіз'.",
      "evidence": "",
      "gold_sql": "SELECT T1.назва ,  T1.тип FROM навчальні_матеріали AS T1 JOIN курси AS T2 ON T1.курс_ід  =  T2.ід WHERE T2.назва  =  'Математичний аналіз';",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0,
      "pred_time": 0.0,
      "execution_match": false,
      "exact_match": false,
      "pred_sql": "SELECT T2.назва, T2.тип\n  FROM курси AS T1\n  INNER JOIN навчальні_матеріали AS T2\n  ON T1.ід = T2.курс_ід"
    },
    {
      "question_id": "університет_gen_014",
      "db_id": "університет",
      "question": "Яка загальна кількість викладачів в університеті?",
      "evidence": "",
      "gold_sql": "SELECT count(*) FROM викладачі WHERE активний = TRUE",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0,
      "pred_time": 0.0,
      "execution_match": true,
      "exact_match": false,
      "pred_sql": "SELECT COUNT(ід)\n  FROM викладачі"
    },
    {
      "question_id": "університет_gen_015",
      "db_id": "університет",
      "question": "Перелічіть студентів (прізвище, ім'я) із середнім балом вище 90.",
      "evidence": "",
      "gold_sql": "SELECT прізвище ,  імя FROM студенти WHERE середній_бал  >  90",
      "status": "Success",
      "agent_time": 0,
      "gold_time": 0.0,
      "pred_time": 0.0,
      "execution_match": true,
      "exact_match": true,
      "pred_sql": "SELECT \"прізвище\", \"імя\"\n  FROM студенти\n  WHERE середній_бал > 90;"
    }
  ]
}